<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>SMILES Specification</title>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="keywords" content="chemistry smiles definition specification">

<style>
body {
    margin: 1em;
    font-family: 'Lucida Grande', Verdana, Helvetica, sans-serif;
    font-size: 0.9em;
    color: #222222;
    background-color: #FFFFFF;
    background-image: none;
}

h1, h2, h3 {
    color: #000000;
}

h4 {
    color: #333333;
    font-size: 1.0em;
    font-style: italic;
}

.et {
    border: 1px solid #999999;
    border-collapse: collapse;
    margin-left: 3em;
}

.ec {
    padding-left: 0.4em;
    padding-right: 0.4em;
    background-color: #F8F8F8;
    border: 1px solid #999999;
}

.ecb  {
    font-weight: bold;
    padding-left: 0.4em;
    padding-right: 0.4em;
    background-color: #F8F8F8;
    border: 1px solid #999999;
}

.ecbc  {
    font-family: Courier;
    font-weight: bold;
    padding-left: 0.4em;
    padding-right: 0.4em;
    background-color: #F8F8F8;
    border: 1px solid #999999;
}
.ect  {
    font-weight: bold;
    padding-left: 0.4em;
    padding-right: 0.4em;
    color: #FFFFFF;
    background-color: #666666;
    border: 1px solid #999999;
}

.toc_2, .toc_2 a:link, .toc_2 a:active, .toc_2 a:hover, .toc_2 a:visited
{
    margin-left:   1em;
    margin-top:    0em;
    margin-bottom: 0em;
    font-decoration: underline;
    font-weight: bold;
}

.toc_3, .toc_3 a:link, .toc_3 a:active, .toc_3 a:hover, .toc_3 a:visited
{
    margin-left:   2em;
    margin-top:    0em;
    margin-bottom: 0em;
    font-decoration: underline;
}

.toc_4, .toc_4 a:link, .toc_4 a:active, .toc_4 a:hover, .toc_4 a:visited
{
    margin-left:   3em;
    margin-top:    0em;
    margin-bottom: 0em;
    font-decoration: underline;
    font-size: 0.9em;
}

.draft {
    font-weight: bold;
    color: #999999;
    font-size: 2em;
}
.draft_text {
    color: #666666;
}

</style>

</head>

<body>

<h1>SMILES Specification</h1>

<p class="draft">DRAFT: 2007-09-26</p>

<hr>

<h2>Table of Contents</h2>

<p class="toc_2"><a href="#1">1. Preface</a></p>
<p class="toc_3"><a href="#1.1">1.1 Purpose</a></p>
<p class="toc_3"><a href="#1.2">1.2 Motivation</a></p>
<p class="toc_3"><a href="#1.3">1.3 Audience</a></p>
<p class="toc_2"><a href="#2">2. Basic SMILES</a></p>
<p class="toc_3"><a href="#2.1">2.1 What is a Molecule? The Valence Model of Chemistry</a></p>
<p class="toc_3"><a href="#2.2">2.2 Lexical Structure of SMILES</a></p>
<p class="toc_4"><a href="#2.2.1">2.2.1 SMILES Grammar</a></p>
<p class="toc_4"><a href="#2.2.2">2.2.2 SMILES Files</a></p>
<p class="toc_3"><a href="#2.3">2.3 Atoms</a></p>
<p class="toc_4"><a href="#2.3.1">2.3.1 Atomic Element, Hydrogens, and Charge</a></p>
<p class="toc_4"><a href="#2.3.2">2.3.2 Isotopes</a></p>
<p class="toc_4"><a href="#2.3.3">2.3.3 "Organic Subset" Elements</a></p>
<p class="toc_4"><a href="#2.3.4">2.3.4 The Wildcard '*' Atomic Symbol</a></p>
<p class="toc_3"><a href="#2.4">2.4 Bonds</a></p>
<p class="toc_3"><a href="#2.5">2.5 Branches</a></p>
<p class="toc_3"><a href="#2.6">2.6 Rings</a></p>
<p class="toc_3"><a href="#2.7">2.7 Aromaticity</a></p>
<p class="toc_4"><a href="#2.7.1">2.7.1 Aromaticity in SMILES</a></p>
<p class="toc_4"><a href="#2.7.2">2.7.2 Definition of Aromaticity</a></p>
<p class="toc_3"><a href="#2.8">2.8 More about Hydrogen</a></p>
<p class="toc_3"><a href="#2.9">2.9 Disconnected Structures</a></p>
<p class="toc_3"><a href="#2.10">2.10 Other Uses of Ring Numbers and Dot Bond</a></p>
<p class="toc_2"><a href="#3">3. Stereochemistry</a></p>
<p class="toc_3"><a href="#3.1">3.1 Scope of Stereochemistry in SMILES</a></p>
<p class="toc_3"><a href="#3.2">3.2 Tetrahedral Centers</a></p>
<p class="toc_3"><a href="#3.3">3.3 Cis/Trans configuration of Double Bonds</a></p>
<p class="toc_3"><a href="#3.4">3.4 Tetrahedral Allene-like Systems</a></p>
<p class="toc_3"><a href="#3.5">3.5 Partial Stereochemistry</a></p>
<p class="toc_2"><a href="#4">4. SMILES Output Normalizations</a></p>
<p class="toc_3"><a href="#4.1">4.1 What is Normalization?</a></p>
<p class="toc_3"><a href="#4.2">4.2 No Normalization</a></p>
<p class="toc_3"><a href="#4.3">4.3 Standard Form</a></p>
<p class="toc_4"><a href="#4.3.1">4.3.1 Atoms</a></p>
<p class="toc_4"><a href="#4.3.2">4.3.2 Bonds</a></p>
<p class="toc_4"><a href="#4.3.3">4.3.3 Cycles</a></p>
<p class="toc_4"><a href="#4.3.4">4.3.4 Starting Atom and Branches</a></p>
<p class="toc_4"><a href="#4.3.5">4.3.5 Aromaticity</a></p>
<p class="toc_4"><a href="#4.3.6">4.3.6 Chirality</a></p>
<p class="toc_3"><a href="#4.4">4.4 Canonical SMILES</a></p>
<p class="toc_2"><a href="#5">5. Relaxed SMILES parsing</a></p>
<p class="toc_2"><a href="#6">6. Proposed Extensions</a></p>
<p class="toc_3"><a href="#6.1">6.1 External R-Groups</a></p>
<p class="toc_3"><a href="#6.2">6.2 Quadruple Bonds</a></p>
<p class="toc_3"><a href="#6.2">6.2 Polymers and Crystals</a></p>
<p class="toc_3"><a href="#6.3">6.3 '@' for Cis/Trans around Double Bonds</a></p>
<p class="toc_3"><a href="#6.5">6.5 Radicals</a></p>
<p class="toc_2"><a href="#7">7. APPENDIX 1: References and Citations</a></p>
<p class="toc_3"><a href="#7.1">7.1 Groups</a></p>
<p class="toc_3"><a href="#7.2">7.2 Documentation</a></p>
<p class="toc_3"><a href="#7.3">7.3 Toolkits</a></p>
<p class="toc_3"><a href="#7.3">7.3 Relevant Scientific Papers</a></p>
<p class="toc_3"><a href="#7.5">7.5 Molecule Editors that can produce SMILES</a></p>

<br>
<hr>

<a name="1"></a><h2>1. Preface</h2>

<a name="1.1"></a><h3>1.1 Purpose</h3>

<p>This document formally defines an open standard version of the
<a href="http://en.wikipedia.org/wiki/Simplified_molecular_input_line_entry_specification">SMILES</a>
language, a typographical <a href="http://en.wikipedia.org/wiki/Line_notation">line notation</a>
for specifying chemical structure.  It is hosted under the banner of the
<a href="blueobelisk.sourceforge.net">Blue Obelisk</a>
project, with the intent to solicit contributions and comments from the
entire computational chemistry community.</p>

<a name="1.2"></a><h3>1.2 Motivation</h3>

<p>SMILES was originally developed as a proprietary standard by <a href="www.daylight.com">Daylight
Chemical Information Systems</a>.  Since the introduction of SMILES in the late 1980's, it has become widely accepted
as a defacto standard for exchange of molecular structures.  Many independent SMILES software packages have been written
in C, C++, Java, Python, LISP, and probably even FORTRAN.</p>

<p>At this point in the history of SMILES, is appropriate for the chemistry community to develop a
new, non-proprietary specification for the SMILES language.  Daylight's
<a href="http://www.daylight.com/dayhtml/doc/theory/theory.smiles.html">SMILES Theory Manual</a> has
long been the "gold standard" for the SMILES language, but as a proprietary specification, it limits
the universal adoption of SMILES.  We salute Daylight for their past contributions, and the
excellent SMILES documentation they provided free of charge for the past two decades.</p>

<a name="1.3"></a><h3>1.3 Audience</h3>

<p>This document is intended for developers designing or improving a SMILES parser or writer.  Due
to the formality of this document, it is not a good tutorial for those trying to learn SMILES. This
document is written with <i>precision</i> as the primary goal, <i>readability</i> is secondary.

<hr>

<a name="2"></a><h2>2. Basic SMILES</h2>

<a name="2.1"></a><h3>2.1 What is a Molecule? The Valence Model of Chemistry</h3>

<p>Before defining the SMILES language, it is important to state the physical model on which it is
based.  The valence model of chemistry, which uses a mathematician's
<a href="http://en.wikipedia.org/wiki/Graph_%28mathematics%29">graph</a> to
represent a molecule.  In a chemical graph, the <i>nodes</i>
are atoms, and the <i>edges</i> are semi-rigid bonds that can be single, double, or
triple according to the rules of 
<a href="http://en.wikipedia.org/wiki/Valence_bond_theory">valence bond theory</a>.</p>

<p>This simple mental model has little resemblance to the underlying quantum-mechanical reality of
electrons, protons and neutrons, yet it has proved to be a remarkably useful approximation of how
atoms behave in close proximity to one another.  However, the valence model is an imperfect
representation of molecular structure, and the SMILES language inherits these imperfections.
Chemical bonds are often tautomeric, aromatic or otherwise fractional rather than neat integer
multiples.  Delocalized bonds, bond-centered bonds, hydrogen bonds and various other inter-atom
forces that are well characterized by a quantum-mechanics description simply don't fit into the
valence model.</p>

<a name="2.2"></a><h3>2.2 Lexical Structure of SMILES</h3>


<a name="2.2.1"></a><h4>2.2.1 SMILES Grammar</h4>

<pre>
           atom : ORGANIC_SYMBOL
                | [ weight ATOMIC_SYMBOL mods ]
                | atom ring_closure
                ;

         weight : NULL | WEIGHT ;

           mods : NULL | mod mods;

            mod : hcount | charge | chiral;
    
 ORGANIC_SYMBOL : B | C | c | N | n | O | o | S | P | F | Cl | Br | I | *

  ATOMIC_SYMBOL : the normal atomic symbol or '*'.  The first letter can be
                  upper or lowercase, the second letter must be lowercase.

         WEIGHT : a positive integer >= 0

	 hcount : H | H HCOUNT ;

	 HCOUNT : a positive integer >= 0

         charge : + | - | ++ | -- | +CHARGE | -CHARGE ;

         CHARGE : an integer >= 0

           bond : NULL | - | = | # | : | . | / | \ ;

           rnum : DIGIT
                | % DIGIT DIGIT
                ;

   ring_closure : rnum
                | bond rnum
                ;

   bonded_atoms : atom
                | atom bond atom
                | atom bond bonded_atoms
                ;

         branch : bonded_atoms ( bond bonded_atoms )
                | branch ( bond bonded_atoms )
                | branch ( bond branch )
                ;

         smiles : bonded_atoms
                | branch bonded_atoms
                ;
</pre>

<a name="2.2.2"></a><h4>2.2.2 SMILES Files</h4>

<p>A <i>SMILES file</i> consists of zero or more SMILES strings, one per line, optionally followed
by at least one whitespace character (space or tab), and other data.  There can be no leading
whitespace before the SMILES string on a line.  The optional whitespace character and data that
follows it are not part of the SMILES specification, and interpretation of this data is up to
applications that use the SMILES file.  Each line of the file is terminated by either a singe LF
character, or by a CR/LF pair of characters (commonly called the "Unix" and "Windows" line
terminators, respectively).  A SMILES parser must accept either line terminator.  A blank line in
the SMILES file, or a line that begins with a whitespace character, should be completely ignored by
a SMILES parser.</p>

<p>There is no formal limit to the length of a SMILES string; SMILES of
over 1 million characters have been assembled for various purposes.  There
is no requirement that a SMILES parser must be able to parse these
exceptionally long SMILES, but as a guideline, all implementations of
SMILES parsers should, at a minimum, accept and correctly parse SMILES
strings of 100,000 characters.  If a SMILES parser encounters a string that
is too long to parse, it must generate a reasonable error message and
continue parsing with the next line of the SMILES file.</p>



<a name="2.3"></a><h3>2.3 Atoms</h3>


<a name="2.3.1"></a><h4>2.3.1 Atomic Element, Hydrogens, and Charge</h4>

<p>An atom is represented by its atomic symbol, enclosed in square brackets,
[].  The first character of the symbol is uppercase and the second (if any) is
lowercase, except that for aromatic atoms (see below), the first
character is lowercase.</p>

<p>Following the atomic symbol, the atom's hydrogen count and charge must
be specified; both default to zero if unspecified.</p>

<ul>
  <li>Hydrogens are specified as "Hn" where "n" is a number such as "H3"; if
      the number is missing ("H"), it means 1 hydrogen.</li>
  <li>Charge is specified by a "+n" or "-n" where "n" is a number; an
      unspecified charge means 1 (either +1 or -1 as appropriate).</li>
  <li>"++" is a synonym for "+2" and "--" is a synonym for "-2".</li>
</ul>

<p>Examples:</p>

<table class="et">
  <tr><td class="ecbc"> [CH4]  </td> <td class="ec"> methane           </td> <td class="ec"> zero charge implied</td></tr>
  <tr><td class="ecbc"> [ClH]  </td> <td class="ec"> hydrochloric acid </td> <td class="ec"> H1 implied, zero charge implied </td> </tr>
  <tr><td class="ecbc"> [ClH1] </td> <td class="ec"> hydrochloric acid </td> <td class="ec"> zero charge implied </td> </tr>
  <tr><td class="ecbc"> [Cl-]  </td> <td class="ec"> chloride anion    </td> <td class="ec"> H0 implied, -1 charge implied </td> </tr>
  <tr><td class="ecbc"> [OH1-] </td> <td class="ec"> hydroxyl anion    </td> <td class="ec"> -1 charge implied </td></tr>
  <tr><td class="ecbc"> [OH-1] </td> <td class="ec"> hydroxyl anion    </td> <td class="ec"> H1 implied </td></tr>
  <tr><td class="ecbc"> [Cu+2] </td> <td class="ec"> copper cation     </td> <td class="ec"> H0 implied </td></tr>
  <tr><td class="ecbc"> [Cu++] </td> <td class="ec"> copper cation     </td> <td class="ec"> +2 charge, H0 implied </td></tr>
</table>

<a name="2.3.2"></a><h4>2.3.2 Isotopes</h4>

<p>Isotopic specification is placed inside the square brackets for an atom
preceeding the atomic symbol; for example:</p>

<table class="et">
  <tr><td class="ecbc"> [13CH4] </td> <td class="ec"> methane-<sup>13</sup>C </td> </tr>
  <tr><td class="ecbc"> [2H+]   </td> <td class="ec"> deuterium ion </td> </tr>
  <tr><td class="ecbc"> [238U]  </td> <td class="ec"> uranium 238 atom </td> </tr>
</table>


<p>If no isotope is specified, an atom is assumed to have either the
naturally occuring isotopes for that element, or the isotope of the element
is unknown, or the isotope is unspecified.  SMILES has no way to
distinguish these three cases.</p>

<a name="2.3.3"></a><h4>2.3.3 "Organic Subset" Elements</h4>

<p>A special subset of elements called the "organic subset" of
<b>B</b>, <b>C</b>, <b>N</b>,<b>O</b>, <b>P</b>, <b>S</b>, <b>F</b>,
<b>Cl</b>, <b>Br</b>, <b>I</b>, and <b>*</b> (the "wildcard" atom) can be
written using the only their atomic symbol (that is, without the square
brackets, H-count, etc.), provided that:</p>

<ul>
  <li>the valence of the atom is in the lowest normal state for that
  element</li>
  <li>there is no net charge on the atom</li>
  <li>there is no isotopic specification for the atom</li>
  <li>there is no chiral specification for the atom</li>
</ul>

<p>The "normal valence" for these elements is defined as:</p>

<table class="et">
  <tr><td class="ect"> Element </td> <td class="ect"> Valence </td> </tr>
  <tr><td class="ecbc"> B </td> <td class="ec"> 3 </td> </tr>
  <tr><td class="ecbc"> C </td> <td class="ec"> 4 </td> </tr>
  <tr><td class="ecbc"> N </td> <td class="ec"> 3 or 5 </td> </tr>
  <tr><td class="ecbc"> O </td> <td class="ec"> 2 </td> </tr>
  <tr><td class="ecbc"> P </td> <td class="ec"> 3 or 5 </td> </tr>
  <tr><td class="ecbc"> S </td> <td class="ec"> 2, 4, or 6 </td> </tr>
  <tr><td class="ecbc"> halogens </td> <td class="ec"> 1 </td> </tr>
  <tr><td class="ecbc"> * </td> <td class="ec"> unspecified </td> </tr>
</table>

<p>Examples:<p>

<table class="et">
  <tr><td class="ecbc"> C  </td> <td class="ec"> methane </td> </tr>
  <tr><td class="ecbc"> N  </td> <td class="ec"> ammonia </td> </tr>
  <tr><td class="ecbc"> Cl </td> <td class="ec"> hydrochloric acid </td> </tr>
</table>

<p><i>Note: The remaining atom properties, chirality and ring-closures, are discussed in later sections.</i></p>

<a name="2.3.4"></a><h4>2.3.4 The Wildcard '*' Atomic Symbol</h4>

<p>The '*' symbol represents an unknown or unspecified atom in a SMILES
string.  It is considered a "stand-in" for the actual atom, and has an
atomic weight of zero.</p>

<table class="et">
  <tr><td class="ecbc"> Oc1(*)ccccc1  </td> <td class="ec"> ortho-substituted phenol </td> </tr>
</table>

<p>The '*' atom does not have any specific electronic properties or
valence.  If specified outside of square brackets, it takes on the valence
implied by its bonds.  If it is inside square brackets, it takes on the
valence implied by its bonds, hydrogens and/or charge.</p>

<p>A '*' atom can be part of an aromatic ring.  When deducing the
aromaticity of a ring system, the ring system is considered aromatic if
there is an element which could replace the '*' and make the ring system
meet the aromaticity rules (see <a href="#2.7">aromaticity</a>, below).

<a name="2.4"></a><h3>2.4 Bonds</h3>

<p>Atoms that are adjacent in a SMILES string are assumed to
be joined by a single or aromatic bond (see <a href="#2.7">aromaticity</a>).  For example:</p>

<table class="et">
  <tr><td class="ecbc"> CC    </td> <td class="ec"> ethane </td> </tr>
  <tr><td class="ecbc"> CCO   </td> <td class="ec"> ethanol </td> </tr>
  <tr><td class="ecbc"> NCCCC </td> <td class="ec"> n-butylamine </td> </tr>
  <tr><td class="ecbc"> CCCCN </td> <td class="ec"> n-butylamine </td> </tr>
</Table>

<p>Double and triple bonds are represented by '=' and '#', respectively:</p>

<table class="et">
  <tr><td class="ecbc"> C=C   </td> <td class="ec"> ethene </td> </tr>
  <tr><td class="ecbc"> C#N   </td> <td class="ec"> hydrogen cyanide </td> </tr>
  <tr><td class="ecbc"> CC#CC </td> <td class="ec"> 2-Butyne </td> </tr>
  <tr><td class="ecbc"> CCC=O </td> <td class="ec"> propanal </td> </tr>
</table>

<p>A single bond can be explicitely represented with '-', but it is almost never
necessary.<p>

<table class="et">
  <tr><td class="ecbc"> C-C     </td> <td class="ec"> same as: CC </td> </tr>
  <tr><td class="ecbc"> C-C-O   </td> <td class="ec"> same as: CCO </td> </tr>
  <tr><td class="ecbc"> C-C=C-C </td> <td class="ec"> same as: CC=CC </td> </tr>
</table>

<p><i>Note: The remaining bond symbols, </i>"<tt>:.\/</tt>"<i>, are syntactically
equivalent to the single, double and triple-bond symbols (they may appear
anywhere a bond symbol is allowed), but the semantics are discussed in
later sections.</i></p>


<a name="2.5"></a><h3>2.5 Branches</h3>

<p>An atom with three or more bonds is called a <i>branched atom</i>, and is
represented using parentheses.</p>

<table class="et">
  <tr> <td class="ec"><img src="2-ethyl-1-butanol.gif"></td> <td class="ecbc"> CCC(CC)CO </td> <td class="ec"> 2-Ethyl-1-butanol     </td> </tr>
</table>

<p>Branches can be nested or "stacked" to any depth:</p>

<table class="et">
  <tr> <td class="ec"><img src="2-4-dimethyl-3-pentanone.gif"></td> <td class="ecbc"> CC(C)C(=O)C(C)C </td> <td class="ec"> 2,4-dimethyl-3-pentanone</td> </tr>
  <tr> <td class="ec">pic here<img src=""></td> <td class="ecbc"> OCC(CCC)C(C(C)C)CCC </td> <td class="ec"> 2-propyl-3-isopropyl-1-propanol </td> </tr>
  <tr> <td class="ec"><img src="thiosulfate.gif"></td> <td class="ecbc"> OS(=O)(=S)O </td> <td class="ec"> thiosulfate </td> </tr>
</table>


<a name="2.6"></a><h3>2.6 Rings</h3>

<p>In a SMILES string such as "C1CCCCC1", the first occurance of a ring-closure
number (an "rnum") creates an "open bond".  When that same rnum is encountered
later in the string, a bond is made between the two atoms, which typically
forms a cyclic structure.

<table class="et">
  <tr> <td class="ec"><img src="cyclohexane.gif"></td> <td class="ecbc"> C1CCCCC1 </td> <td class="ec"> cyclohexane</td> </tr>
  <tr> <td class="ec"><img src="perhydroisoquinoline.gif"></td> <td class="ecbc"> N1CC2CCCC2CC1 </td> <td class="ec"> perhydroisoquinoline </td> </tr>
</table>

<p>  If a bond symbol is present between the atom and
rnum, it must be present on <i>both</i> bonded atoms.</p>

<table class="et">
  <tr> <td class="ec"><img src="cyclohexane.gif"></td> <td class="ecbc"> C=1CCCCC=1 </td> <td class="ec"> cyclohexene</td> </tr>
  <tr> <td class="ec">&nbsp;</td> <td class="ecbc"> C=1CCCC1   </td> <td class="ec"> <i>invalid</i> </td> </tr>
  <tr> <td class="ec">&nbsp;</td> <td class="ecbc"> C1CCCC=1   </td> <td class="ec"> <i>invalid</i> </td> </tr>
  <tr> <td class="ec">&nbsp;</td> <td class="ecbc"> C-1CCCC=1  </td> <td class="ec"> <i>invalid</i> </td> </tr>
</table>

<p>Ring closures must be matched pairs in a SMILES string, for example, "C1CCC"
is not a valid SMILES.</p>

<p>It is permissable to re-use ring-closure numbers.  Once a particular number
has been encountered twice, that number is available again for subsequent ring closures.<p>

<table class="et">
  <tr>
    <td class="ec" rowspan="2"><img src="dicyclohexyl.gif"></td>
    <td class="ecbc">
      C1CCCCC1C1CCCCC1
    </td>
     <td class="ec">
      dicyclohexyl
    </td>
    <td class="ec" rowspan="2">both SMILES are valid</td>
  </tr>
  <tr>
    <td class="ecbc">
      C1CCCCC1C2CCCCC2
    </td>
    <td class="ec">
      dicyclohexyl
    </td>
  </tr>
</table>

<p>Note that the ring number zero is valid, for example cyclohexane can be
written "C0CCCCC0".<p>

<p>Two-digit ring numbers are permitted, but must be preceeded by the percent
"%" symbol, such as "C%25CCCCC%25" for cyclohexane. Three-digit numbers and
larger are never permitted.  However, note that three digits are not invalid; for
example, "C%123" is the same as "C3%12", that is, an atom with two rnum
specifications.</p>

<p>The digit(s) representing a ring-closure are interpreted as a number, not a
symbol, and two rnums match if their numbers match.  Thus, C1CCCCC%01 is a
valid SMILES and is the same as C1CCCCC1.  Likewise, C%00CCCCC%00 is a
valid SMILES.</p>

<p>A single atom can have several ring-closure numbers, such as this spiro
atom:<p>

<table class="et">
  <tr> <td class="ec"><img src="spiro.gif"></td> <td class="ecbc"> C12(CCCCC1)CCCCC2 </td> <td class="ec"> name? </td> </tr>
</table>


<a name="2.7"></a><h3>2.7 Aromaticity</h3>

<a name="2.7.1"></a><h4>2.7.1 Aromaticity in SMILES</h4>

<p>Aromaticity can be represented in one of two ways in a SMILES.  The
Kekul&eacute; form is always acceptable.  For convenience and to provide a
<a href="#4">normalized form</a> for output, an atom symbol that
begins with a lowercase letter is aromatic.  For example:</p>

<table class="et">
  <tr> <td class="ec"><img src="benzene.gif"></td> <td class="ecbc"> c1ccccc1<br>C1=CC=CC=C1 </td> <td class="ec"> benzene </td> </tr>
  <tr> <td class="ec"><img src="indane.gif"></td> <td class="ecbc"> c1ccc2CCCc2c1<br>C1=CC=CC(CCC2)=C12 </td> <td class="ec"> indane </td> </tr>
  <tr> <td class="ec"><img src="furan.gif"></td> <td class="ecbc"> c1occc1<br>C1OC=CC=C1<br> </td> <td class="ec"> furan </td> </tr>
</table>

<p>Aromaticity is deduced and/or confirmed by a SMILES parser.  In an aromatic system, all atoms in
the ring system must be sp<sup>2</sup> hybridized, and the number of <a href="http://en.wikipedia.org/wiki/Pi_electron"
title="Pi_electron">Pi electrons</a> must meet
<a href="http://en.wikipedia.org/wiki/H%C3%BCckel's_rule">H&uuml;ckel's 4N+2 criterion</a>.</p>

<p>This meaning of <i>aromaticity</i> for SMILES is strictly for
<a href="http://www.emolecules.com/doc/cheminformatics-101.htm">cheminformatics</a> purposes.  It is
<i>not</i> intended to imply anything about the physical or chemical properties of a substance.  In
many or most cases, the SMILES definition of aromaticity will match the chemist's notion of what is
aromatic, but in some cases it will not.  The SMILES definition of aromaticity is designed to
facilitate <a href="#4">normalization</a> of SMILES, not to predict chemical properties.
</p>

<a name="2.7.2"></a><h4>2.7.2 Definition of Aromaticity</h4>

<p><i>This definition of aromaticity needs considerable work.  For a good summary of the question of
aromaticity, see:</i></p>

<p style="padding-left:2em;">
<a href="http://wiki.cubic.uni-koeln.de/cdkwiki/doku.php?id=smiles_aromaticity">http://wiki.cubic.uni-koeln.de/cdkwiki/doku.php?id=smiles_aromaticity</a></p>

<p><i>The definition below is the one that Daylight has described in public meetings, but I believe
there are more subtle rules that Daylight actually use in their SMILES Toolkit. -- CJ</i></p>

<p>The formal meaning of a lowercase "aromatic" element in a SMILES string is that the atom is
in the sp<sup>2</sup> electronic state.  When generating a normalized SMILES, all sp<sup>2</sup>
atoms are written using a lowercase first character of the atomic symbol.  When parsing a SMILES,
a parser must note the sp<sup>2</sup> designation of each atom on input, then when the parsing is
complete, the SMILES software must verify that electrons can be assigned without violating the
valence rules, consistent with the sp<sup>2</sup> markings, the specified or implied
hydrogens, external bonds, and charges on the atoms.</p>

<p>This implies that the lowercase atomic symbols do <i>not</i> necessarily represent aromatic
atoms.  For example:</p>

<table class="et">
  <tr>
    <td class="ec"><img src="2-4-hexadiene.gif"></td>
    <td class="ecbc"> CccccC<br>CC=CC=CC </td>
    <td class="ec"> 2,4-hexadiene<br><i>(both SMILES are valid)</i> </td>
  </tr>
  <tr>
    <td class="ec"><img src="cyclobutadiene.gif"></td>
    <td class="ecbc"> c1ccc1<br>C1=CC=C1 </td>
    <td class="ec"> cyclobutadiene<br><i>(both SMILES are valid)</i> </td>
  </tr>
  <tr>
    <td class="ec">&nbsp;</td>
    <td class="ecbc"> CcccC</td>
    <td class="ec"> Invalid SMILES<br>electrons can't be assigned </td>
  </tr>
</table>

<p>Even numbers of adjacent lower case "c" or "n" are interpreted as conjugated chains. So cccc is
1,3 butadiene, Ccc is propene, C1ccccC1 is 1,3 cyclohexadiene and CnnC is azomethane.</p>


<a name="2.8"></a><h3>2.8 More about Hydrogen</h3>

<p>Hydrogens in a SMILES can be represented in three different ways:</p>

<table class="et">
  <tr>
    <td class="ec">   implicit hydrogen </td>
    <td class="ecbc"> C </td>
    <td class="ec">   methane </td>
    <td class="ec">   h-count deduced from normal valence (4)</td>
  </tr>
  <tr>
    <td class="ec">   atom property </td>
    <td class="ecbc"> [CH4] </td>
    <td class="ec">   methane </td>
    <td class="ec">   h-count specified for heavy atom</td>
  </tr>
  <tr>
    <td class="ec">   explicit hydrogens </td>
    <td class="ecbc"> [H]C([H])([H])[H] </td>
    <td class="ec">   methane </td>
    <td class="ec">   hydrogens represented as normal atoms</td>
  </tr>
</table>

<p>All three forms are equivalent.  However, some situations require that one form must be used:</p>

<ul>
  <li>Implicit hydrogen count may only be used for elements of the <a href="#2.3.3">organic elements</a> subset.</li>
  <li>Any atom that is specified with square brackets <i>must</i> have its attached hydrogens 
      explicitely represented, either as a hydrogen count or as normal atoms.</li>
</ul>

<p>A hydrogen that meets one of the following criteria must be represented as an explicit atom:</p>

<ul>
  <li>hydrogens with charge ([H+])</li>
  <li>a hydrogen connected to another hydrogen (such as molecular hydrogen, [H][H])</li>
  <li>hydrogens with more than one bond (bridging hydrogens)</li>
  <li>Deuterium [2H] and tritium [3H]</li>
</ul>

<p>It is permissible to use a mixture of an atom h-count and explicit hydrogen.  In such a case,
the atom's hydrogen count is the sum of the atomic h-count property and the number of attached
hydrogens.  For example:</p>

<table class="et">
  <tr> <td class="ecbc"> [CH4]       </td> <td class="ec"> methane </td> </tr>
  <tr> <td class="ecbc"> [H][CH2][H] </td> <td class="ec"> methane </td> </tr>
  <tr> <td class="ecbc"> [2H][CH3]C  </td> <td class="ec"> deuteroethane </td> </tr>
</table>


<a name="2.9"></a><h3>2.9 Disconnected Structures</h3>

<p>The period "." (also called a "dot bond") is syntactically a bond symbol, but it means that the atoms
to its left and right are <i>not</i> bonded.  The most common use of the dot-bond symbol is to
represent disconnected and ionic compounds.</p>

<table class="et">
  <tr> <td class="ec"><img src="sodium-chloride.gif"></td> <td class="ecbc"> [Na+].[Cl-]  </td> <td class="ec">  sodium chloride </td></tr>
  <tr> <td class="ec"><img src="phenol-2-amino-ethanol.gif"></td> <td class="ecbc"> Oc1ccccc1.NCCO   </td> <td class="ec"> phenol, 2-amino ethanol  </td> </tr>
  <tr> <td class="ec"><img src="diammonium-thiosulfate.gif"></td> <td class="ecbc"> [NH4+].[NH4+].[O-]S(=O)(=O)[S-]      </td> <td class="ec"> diammonium thiosulfate </td> </tr>
</table>

<p>The dot can appear anywhere that a bond symbol is allowed, for example, the phenol example above
can also be written:</p>

<table class="et">
  <tr> <td class="ec" rowspan="2"><img src="phenol-2-amino-ethanol.gif"></td> <td class="ecbc"> c1cc(O.NCCO)ccc1   </td> <td class="ec"> phenol, 2-amino ethanol  </td> </tr>
  <tr> <td class="ecbc"> Oc1cc(.NCCO)ccc1   </td> <td class="ec"> phenol, 2-amino ethanol  </td> </tr>
</table>

<p>The second example above is an odd, but legal, use of parentheses and the dot bond, since the
syntax allows a dot anywhere a regular bond could appear.</p>

<p>Although dot-bonds are commonly used to represent compounds with disconnected parts, a dot-bond
does <i>not</i> in itself mean that there are disconnected parts in the compound.   See the
following section regarding ring digits for some examples that illustrate this.<p>

<a name="2.10"></a><h3>2.10 Other Uses of Ring Numbers and Dot Bond</h3>

<p>A ring-number specifications ("rnum") is most commonly used to specify a ring-closure bond, but
when used with the "." dot-bond symbol, it can also specify a non-ring bond.  Two rnums in a SMILES
mean that the two atoms are bonded.  A dot-bond "." means that the atoms to which it
is adjacent in the SMILES string are <i>not</i> bonded to each other.  The following SMILES
illustrate this feature of SMILES:</p>

<table class="et">
  <tr> <td class="ec" align="center"> CC </td> <td class="ecbc"> C1.C1  </td> <td class="ec"> ethane </td> </tr>
  <tr> <td class="ec" align="center"> CCC </td> <td class="ecbc"> C1.C12.C2  </td> <td class="ec"> propane</td> </tr>
  <tr> <td class="ec"><img src="1-bromo-2-3-dichlorobenzene.gif"></td> <td class="ecbc"> c1c2c3c4cc1.Br2.Cl3.Cl4  </td> <td class="ec"> 1-bromo-2,3-dichlorobenzene </td> </tr>
</table>

<p>This feature of SMILES provides a convenient method of enumerating the
molecules of a combinatorial library using string concatenation.</p>

<hr>

<a name="3"></a><h2>3. Stereochemistry</h2>

<a name="3.1"></a><h3>3.1 Scope of Stereochemistry in SMILES</h3>

<p>A SMILES string can specify the cis/trans configuration around a double bond,
and can specify the chiral configuration of specific atoms in a molecule.</p>

<p>SMILES strings do <i>not</i> represent all types of stereochemistry.  Examples of
stereochemistry that cannot be encoded into a SMILES include:

<ul>
  <li>Gross conformational left or right handedness such as helicenes</li>
  <li>Mechanical interferences, such as rotatable bonds that are
  constrained by mechanical interferences</li>
  <li>Gross conformational stereochemistry such as the shape of a protein after folding</li>
</ul>


<a name="3.2"></a><h3>3.2 Tetrahedral Centers</h3>

<p>SMILES uses an atom-centered chirality specification, in which the atom's left-to-right order in
the SMILES string itself is used as the basis for the chirality marking.

<table class="et">
  <tr><td class="ec" align="center" colspan="2"><b>Tetrahedral Chirality</b></td></tr>
  <tr>
    <td class="ec">look from N toward C (chiral center)...</td>
    <td class="ec"> list the neighbors anticlockwise</td>
  </tr>
  <tr>
    <td class="ec"   rowspan="3" align="center"><img src="tetrahedral.gif"></td>
    <td class="ecbc" align="center">N[C@](Br)(O)C</td>
  </tr>
  <tr>
    <td class="ec"> ...or clockwise</td>
  </tr>
  <tr>
    <td class="ecbc" align="center">N[C@@](Br)(C)O</td>
  </tr>
</table>

<p>For the structure above, starting with the nitrogen atom, one "looks" toward the chiral
center. The the remaining three neighbor atoms are written by listing them in anticlockwise order using the '@'
chiral property on the atom, or in clockwise order using the '@@' chiral property, as illustrated
above.  The '@' symbol is a "visual mnemonic" in that the spiral around the character goes in the
anticlockwise direction, and means "anticlockwise" in the SMILES string (thus, '@@' can be thought of
as anti-anticlockwise).<p>

<p>A chiral center can be written starting from any of its neighbor atoms, and the choice of
whether to list the remaining neighbor in clockwise or anticlockwise order is also arbitrary.  The
following SMILES are all equivalent and all specify the exact same chiral center illustrated above:</p>

<table class="et">
  <tr> <td class="ecbc"> N[C@](Br)(O)C  </td> <td class="ecbc"> Br[C@](O)(N)C </td> </tr>
  <tr> <td class="ecbc"> O[C@](Br)(C)N  </td> <td class="ecbc"> Br[C@](C)(O)N </td> </tr>
  <tr> <td class="ecbc"> C[C@](Br)(N)O  </td> <td class="ecbc"> Br[C@](N)(C)O </td> </tr>
  <tr> <td class="ecbc"> C[C@@](Br)(O)N </td> <td class="ecbc"> Br[C@@](N)(O)C </td> </tr>
</table>

<p>If one of the neighbor atoms is a hydrogen and is represented as an atomic property of the
chiral center (rather than explicitely as [H]), then it is considered to be the first atom in the
clockwise or anticlockwise accounting.  For example, if we replaced the bromine in the illustration
above with a hydrogen atom, its SMILES would be:</p>

<table class="et">
  <tr> <td class="ecbc">  N[C@H](O)C</td></tr>
</table>

<p><i>Note: Daylight's chirality specification is much more complete than this, and includes square
planar, octahedral, and trigonal-bipyramidal configurations.  Each of these is a assigned a symbol,
e.g. '@' is simply a shorthand for '@TH1'.  This section should be extended to include the full
chirality specification, even though most non-Daylight SMILES parsers are not capable of processing
these chiral configurations.</i></p>

<a name="3.3"></a><h3>3.3 Cis/Trans configuration of Double Bonds</h3>

<p>The configuration of atoms around double bonds is specified by the bond symbols '/' and '\'.
These symbols always come in pairs, and indicate cis or trans with a visual "same side" or
"opposite side" concept.  That is:</p>

<table class="et">
  <tr>
    <td class="ec"><img src="trans-difluoroethene.gif"></td>
    <td class="ecbc"> F/C=C/F<br>F\C=C\F  </td>
    <td class="ec"> trans-difluoroethene<br><i>(both SMILES are equivalent)</i> </td>
  </tr>
  <tr>
    <td class="ec"><img src="cis-difluoroethene.gif"></td>
    <td class="ecbc"> F\C=C/F<br>F/C=C\F </td>
    <td class="ec"> cis-difluoroethene<br><i>(both SMILES are equivalent)  </td>
  </tr>
</table>

<p>The "visual interpretation" of the '/' and '\' symbol is that they are thought of as bonds that
"point" above or below the allenal carbon.  That is, "F/C=C/Br" means "The F is below the first carbon,
and the Br is above the second carbon," leading to the interpretation of a trans configuration.

<p>This notation can be confusing when parentheses follow one of the allenal carbons:</p>

<table class="et">
  <tr>
    <td class="ecbc">
      F/C=C/F<br>
      C(\F)=C\F
    </td>
    <td class="ec">
      trans-difluoroethene</i>
    </td>
  </tr>
  <tr>
    <td class="ecbc">
      F\C=C/F<br>
      C(/F)=C/F
    </td>
    <td class="ec">
      cis-difluoroethene
    </td>
  </tr>
</table>

<p>The "visual interpretation" of the "up-ness" or "down-ness" of each single
bond is <i>relative to the carbon atom</i>, not the double bond, so the sense of the symbol changed
when the fluorine atom moved from the left to the right side of the allenal carbon atom.</p>

<p><i>Note: This point was not well documented in earlier SMILES specifications, and several SMILES
interpreters are known to interpret the '/' and '\' symbols incorrectly.</i></p>

<p>A SMILES with conflicting up/down specifications is invalid:</p>

<table class="et">
  <tr>
    <td class="ecbc">
      C/C(\F)=C/F
    </td>
    <td class="ec">
      Invalid SMILES: Both the methyl and fluorine are "down" relative to the first allenal carbon.
    </td>
  </tr>
</table>


<p>It is permissible, but not required, that every atom attached to a double bond be marked.  As
long as at least two neighbor atoms, one on each end of the double bond, is marked, the "up-ness" or
"down-ness" of the unmarked neighbors can be deduced.</p>

<table class="et">
  <tr>
    <td class="ecbc">
      F/C(C)=C/F
    </td>
    <td class="ec">
      trans-difluoro configuration, position of methyl is implied
    </td>
  </tr>
</table>


<p>Extended cis and trans configurations can be specified for conjugated allenes with an odd number
of double bonds:</p>

<table class="et">
  <tr> <td class="ecbc"> F/C=C=C=C/F  </td> <td class="ec"> trans-difluorobutatriene </td> </tr>
  <tr> <td class="ecbc"> F/C=C=C=C\F  </td> <td class="ec"> cis-difluorobutatriene </td> </tr>
</table>


<a name="3.4"></a><h3>3.4 Tetrahedral Allene-like Systems</h3>

<p>Extended tetrahedral configurations can be specified for conjugated allenes with an even number
of double bonds.  The normal tetrahedral rules using '@' and '@@' apply, but the "neighbor" atoms
to which the chirality refers are at the ends of the allenal system.  For example:</p>

<table class="et">
  <tr> <td class="ec"><img src="tetrahedral-allene.gif"></td><td class="ecbc"> NC(Br)=[C@]=C(O)C </td> </tr>
</table>
  
<p>To determine the correct clockwise or anticlockwise specification, the allene is conceptually
"collapsed" into a single tetrahedral chiral center, and the resulting chirality is marked as a
property of the center atom of the extended allene system.</p>

<a name="3.5"></a><h3>3.5 Partial Stereochemistry</h3>

<p>SMILES allows partial stereochemical specifications.  It is permissible for some chiral centers
or double bonds to have stereochemical markings in the SMILES, while others in the same SMILES
string do not.  For example:</p>

<table class="et">
  <tr> <td class="ecbc"> F/C=C/C/C=C\C  </td> <td class="ec"> completely specified  </td> </tr>
  <tr> <td class="ecbc"> F/C=C/CC=CC  </td> <td class="ec"> partially specified </td> </tr>
  <tr> <td class="ecbc"> N1[C@H](Cl)[C@@H](Cl)C(Cl)CC1  </td> <td class="ec"> partially specified</td> </tr>
</table>
<br>

<hr>

<a name="4"></a><h2>4. SMILES Output Normalizations</h2>

<a name="4.1"></a><h3>4.1 What is Normalization?</h3>

<p>A wide variety of SMILES strings are acceptable as input.  For example, all of the following
represent ethanol:</p>

<table class="et">
  <tr> <td class="ecbc"> CCO  </td> <td class="ec"> ethanol  </td> </tr>
  <tr> <td class="ecbc"> OCC  </td> <td class="ec"> ethanol  </td> </tr>
  <tr> <td class="ecbc"> C(O)C  </td> <td class="ec"> ethanol  </td> </tr>
  <tr> <td class="ecbc"> [CH3][CH2][OH]  </td> <td class="ec"> ethanol  </td> </tr>
  <tr> <td class="ecbc"> [H][C]([H])([H])C([H])([H])[O][H]  </td> <td class="ec"> ethanol  </td> </tr>
</table>

<p>However, it is desirable to write SMILES in more standard forms; the first two forms above are
preferred by most chemists, and require fewer bytes to store on a computer. Several levels of
normalization of SMILES are recommended for systems that generate SMILES strings.  Although these are not
mandatory in any sense, they should be considered guidelines for software engineers creating SMILES systems.

<a name="4.2"></a><h3>4.2 No Normalization</h3>

<p>The simplest "normalization" is no normalization.  SMILES can be written in any form whatsoever,
as long as they meet the rules for SMILES.  Some examples of systems that might produce
un-normalized SMILES are:</p>

<ul>
<li> A system that enumerates combinatorial libraries using the rnum/dot-bond technique 
     <a href="#2.11">discussed above</a>.  SMILES produced by such a system will typically be a series
     of partial SMILES that are concatenated with dots into a complete molecule.</li>
<li> Simple pass-through "filters" that don't have a full SMILES writer, but merely copy the input
     SMILES to the output.  An example might be a molecular modeling program that reads SMILES to
     generates logP values, but has no capability to convert its molecular data structures back to a
     SMILES; instead it just copies its input SMILES to its output.</li>
</ul>


<a name="4.3"></a><h3>4.3 Standard Form</h3>

<p>The "standard form" of a SMILES is designed to produce a compact SMILES,
and one that is human readable (for smaller molecules).</p>

<p><i>Note: In the example below, the "Wrong" SMILES examples are all valid SMILES, but are "wrong"
in the sense that they are not the preferred form for standard normalization.</i></p>

<a name="4.3.1"></a><h4>4.3.1 Atoms</h4>

<table class="et">
  <tr>
    <td class="ecb">
      Correct
    </td>
    <td class="ecb">
      Wrong
    </td>
    <td class="ecb">
      Normalization Rule
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      CC
    </td>
    <td class="ecbc">
      [CH3][CH3]
    </td>
    <td class="ec">
      Write atoms in the "organic subset" as bare atomic symbol whenever possible.
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      [CH3-]
    </td>
    <td class="ecbc">
      [CH3-1]
    </td>
    <td class="ec">
      If the charge is +1 or -1, leave off the digit.
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      C[13CH](C)C
    </td>
    <td class="ecbc">
      C[13CH1](C)C
    </td>
    <td class="ec">
      If the hydrogen count is 1, leave off the digit.
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      [CH3-]<br>
      C[C@H](Br)Cl
    </td>
    <td class="ecbc">
      [C-H3]<br>
      C[CH@](Br)Cl
    </td>
    <td class="ec">
      Always write the atom properties in the order: Chirality, hydrogen-count, charge.
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      [CH3-]      
    </td>
    <td class="ecbc">
      [H][C-]([H])[H]
    </td>
    <td class="ec">
      Represent hydrogens as a property of the heavy atom rather than as explicit atoms,
      unless other rules (e.g. [2H]) require that the hydrogen be explicit.
    </td>
  </tr>

</table>

<a name="4.3.2"></a><h4>4.3.2 Bonds</h4>

<table class="et">

  <tr>
    <td class="ecb">
      Correct
    </td>
    <td class="ecb">
      Wrong
    </td>
    <td class="ecb">
      Normalization Rule
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      CC
    </td>
    <td class="ecbc">
      C-C
    </td>
    <td class="ec" rowspan="2">
      Never write '-' (single bond) or ':' (aromatic bond).  Bonds are single or aromatic by
      default (as appropriate), and it is never necessary to include them in a SMILES.
    </td>
  </tr>
  <tr>
    <td class="ecbc">
      c1ccccc1
    </td>
    <td class="ecbc">
      c:1:c:c:c:c:c:1
    </td>
  </tr>

</table>


<a name="4.3.3"></a><h4>4.3.3 Cycles</h4>

<table class="et">

  <tr>
    <td class="ecb">
      Correct
    </td>
    <td class="ecb">
      Wrong
    </td>
    <td class="ecb">
      Normalization Rule
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      c1ccccc1C2CCCC2
    </td>
    <td class="ecbc">
      c1ccccc1C1CCCC1
    </td>
    <td class="ec">
      Don't reuse ring-closure digits.
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      c1ccccc1C2CCCC2
    </td>
    <td class="ecbc">
      c0ccccc0C1CCCC1
    </td>
    <td class="ec">
      Begin ring numbering with 1, not zero (or any other number)
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      CC1=CCCCC1
    </td>
    <td class="ecbc">
      CC=1CCCCC=1
    </td>
    <td class="ec">
      Avoid making a ring-closure on a double or triple bond.  For the ring-closure digits, choose
      a single bond whenever possible.
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      C1CC2CCCCC2CC1
    </td>
    <td class="ecbc">
      C12(CCCCC1)CCCCC2
    </td>
    <td class="ec">
      Avoid starting a ring system on an atom that is in two or more rings, such that two ring-closure
      bonds will be on the same atom.
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      C1CCCCC1
    </td>
    <td class="ecbc">
      C%01CCCCC%01
    </td>
    <td class="ec">
      Use the simpler single-digit form for rnums less than 10.
    </td>
  </tr>

</table>


<a name="4.3.4"></a><h4>4.3.4 Starting Atom and Branches</h4>


<table class="et">
  <tr>
    <td class="ecb">
      Correct
    </td>
    <td class="ecb">
      Wrong
    </td>
    <td class="ecb">
      Normalization Rule
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      OCc1ccccc1      
    </td>
    <td class="ecbc">
      c1cc(CO)ccc1
    </td>
    <td class="ec">
      Start on a terminal atom if possible.
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      CC(C)CCCCCC
    </td>
    <td class="ecbc">
      CC(CCCCCC)C      
    </td>
    <td class="ec">
      Try to make "side chains" short; pick the longest chains as the "main branch"
      of the SMILES.
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      OCCC
    </td>
    <td class="ecbc">
      CCCO
    </td>
    <td class="ec">
      Start on a heteroatom if possible.
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      CC
    </td>
    <td class="ecbc">
      C1.C1
    </td>
    <td class="ec">
      Only use dots and ring-closure bonds for disconnected components.
    </td>
  </tr>

</table>

<a name="4.3.5"></a><h4>4.3.5 Aromaticity</h4>

<table class="et">
  <tr>
    <td class="ecb">
      Correct
    </td>
    <td class="ecb">
      Wrong
    </td>
    <td class="ecb">
      Normalization Rule
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      c1ccccc1
    </td>
    <td class="ecbc">
      C1=CC=CC=C1
    </td>
    <td class="ec">
      Write the aromatic form in preference to the Kekul&eacute; form.
    </td>
  </tr>
</table>

<a name="4.3.6"></a><h4>4.3.6 Chirality</h4>

<table class="et">
  <tr>
    <td class="ecb">
      Correct
    </td>
    <td class="ecb">
      Wrong
    </td>
    <td class="ecb">
      Normalization Rule
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      BrC(Br)C
    </td>
    <td class="ecbc">
      Br[C@H](Br)C
    </td>
    <td class="ec">
      Remove chiral markings for atoms that are not chiral.
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      FC(F)=CF
    </td>
    <td class="ecbc">
      F/C(/F)=C/F
    </td>
    <td class="ec">
      Remove cis/trans markings for double bonds that are not cis or trans.
    </td>
  </tr>

</table>

<a name="4.4"></a><h3>4.4 Canonical SMILES</h3>

<p>A <i>Canonical SMILES</i> is one that follows the <a href="#4.3">Standard
Form</a> above, and additionally, always writes the atoms and bonds of any particular molecule in
the <i>exact same order</i>, regardless of the source of the molecule or its history in the
computer.  Here are a few examples of Canonical versus non-Canonical SMILES:</p>

<table class="et">

  <tr>
    <td class="ecb">
      Canonical SMILES
    </td>
    <td class="ecb">
      Non-canonical
    </td>
    <td class="ecb">
      Name
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      OCC
    </td>
    <td class="ecbc">
      CCO<br>
      C(C)O
    </td>
    <td class="ec">
      ethanol
    </td>
  </tr>

  <tr>
    <td class="ecbc">
      Oc1ccccc1
    </td>
    <td class="ecbc">
      c1ccccc1O<br>
      c1(O)ccccc1<br>
      c1(ccccc1)O
    </td>
    <td class="ec">
      phenol
    </td>
  </tr>

</table>

<p>The primary use of Canonical SMILES is in
<a href="http://www.emolecules.com/doc/cheminformatics-101.htm">cheminformatics</a>
systems.  A molecule's structure, when expressed as a canonical SMILES,
will always yield the same SMILES string, which allows a chemical database
system to:</p>

<ul>
  <li>Create a unique name (the SMILES) for each molecule in the system</li>
  <li>Consolidate data about one molecule from a variety of sources into a
  single record</li>
  <li>Given a molecule, find its record in the database</li>
</ul>

<p>Canonical SMILES should <i>not</i> be considered a universal, global
identifier (such as a permanent name that spans the WWW).  Two
systems that produces a canonical SMILES may use different rules in their
code, or the same system may be improved or have bugs fixed as time passes,
thus chaning the SMILES it produces.  A Canonical SMILES is primarily
useful in a single database, or a system of related databases or information,
in which all molecules were created using a single canonicalizer.</p>

<p>The rules (algorithms) by which the canonical ordering of the atoms in a
SMILES are generated are quite complex, and beyond the scope of this
document.  There are many chemistry and mathematical graph-theory
papers describing the canonical labeling of a graph, and writing a
canonical SMILES string.  See the <a href="#7.3">Appendix</a> for further
information.</p>

<p>Those considering Canonical SMILES for a database system should also investigate
<a href="http://www.iupac.org/inchi">InChI</a>, a canonical naming system for chemicals that is an
approved IUPAC naming convention.</p>


<hr>

<a name="5"></a><h2>5. Relaxed SMILES parsing</h2>

<p>Several SMILES-generating systems are in use that either generate
incorrect SMILES, or that interpreted some of the ambiguous features of the
original SMILES specification in different ways.  Although these SMILES are
illegal according to the formal SMILES specification, it is often useful to
parse them, in order to make use of the information that accompanies these
SMILES.</p>

<p>These "relaxed" SMILES rules should only be allowed when the user
(presumably after thinking about the consequences) requests it.  A SMILES
parser that implements allows any or all of these "relaxed" rules <i>must
not do it by default</i>.  The user must specifically request these relaxed
rules before a parser can accept such SMILES.</p>

<p>The following table lists "relaxed" rules that SMILES parsers may
accept.</p>

<table class="et">

  <tr>
    <td class="ecb">
      Rule
    </td>
    <td class="ecb">
      Example
    </td>
    <td class="ecb">
      Interpred as...
    </td>
    <td class="ecb">
      Details
    </td>
  </tr>

  <tr>
    <td class="ec" rowspan="3">
      Extra parentheses
    </td>
    <td class="ecbc">
      C((C))O
    </td>
    <td class="ecbc">
      C(C)O
    </td>
    <td class="ec"  rowspan="3">
      Extra parentheses are ignored in places where there is no ambiguity
      as to the meaning.  Note that the form "(CO)N" is never allowed,
      since it isn't clear which atom the nitrogen should connect to.
    </td>
  </tr>
  <tr>
    <td class="ecbc">
      C((C))O
    </td>
    <td class="ecbc">
      C(C)O
    </td>
  </tr>
  <tr>
    <td class="ecbc">
      (N1CCCC1)
    </td>
    <td class="ecbc">
      N1CCCCC1
    </td>
  </tr>

  <tr>
    <td class="ec" rowspan="3">
      Misplaced dots
    </td>
    <td class="ecbc">
      [Na+]..[Cl-]
    </td>
    <td class="ecbc">
      [Na+].[Cl-]
    </td>
    <td class="ec" rowspan="3">
      Two or more dot-bonds in a row are condensed into one.  A leading or
      trailing dot-bond is ignored.  Note that a dot that starts a branch
      is <i>legal</i> in strict SMILES; for example,
      C1CC(.[Na+])CC1[O-] is a legal (though strange) SMILES.
    </td>
  </tr>
  <tr>
    <td class="ecbc">
      .CCO
    </td>
    <td class="ecbc">
      CCO
    </td>
  </tr>
  <tr>
    <td class="ecbc">
      CCO.
    </td>
    <td class="ecbc">
      CCO
    </td>
  </tr>

  <tr>
    <td class="ec">
      Mismatched Ring Bonds
    </td>
    <td class="ecbc">
      C1CCC
    </td>
    <td class="ecbc">
      CCCC
    </td>
    <td class="ec">
      Mismatched ring bonds are ignored.  Note that this is almost always a
      bad idea.  For example, "C1CCCCC2" is almost certainly supposed to be
      cyclohexane "C1CCCCC1", but with "relaxed" parsing would be
      interpreted as hexane.
    </td>
  </tr>

  <tr>
    <td class="ec" rowspan="3">
      Invalid Cis/Trans specification
    </td>
    <td class="ecbc">
      C/C=C
    </td>
    <td class="ecbc">
      CC=C
    </td>
    <td class="ec" rowspan="3">
      Mismatched or incomplete cis/trans bonds are ignored.
    </td>
  </tr>
  <tr>
    <td class="ecbc">
      C/C=CC
    </td>
    <td class="ecbc">
      CC=CC
    </td>
  </tr>
  <tr>
    <td class="ecbc">
      CC/=C/C
    </td>
    <td class="ecbc">
      CC=CC
    </td>
  </tr>

  <tr>
    <td class="ec">
      Conflicting cis/trans specification
    </td>
    <td class="ecbc">
      C/C(\F)=C/C
    </td>
    <td class="ecbc">
      CC(F)=CC
    </td>
    <td class="ec">
      Conflicting cis/trans bonds are ignored. (In this case, both the
      methyl and fluorine on the left are shown as <i>trans</i> to the methyl
      on the right, an impossible configuration.)
    </td>
  </tr>

  <tr>
    <td class="ec" rowspan="2">
      D and T
    </td>
    <td class="ecbc">
      D[CH3]
    </td>
    <td class="ecbc">
      [2H][CH3]
    </td>
    <td class="ec" rowspan="2">
      The symbols "D" and "T" are treated as synonyms for [2H] and [3H].
    </td>
  </tr>
  <tr>
    <td class="ecbc">
      T[CH3]
    </td>
    <td class="ecbc">
      [3H][CH3]
    </td>
  </tr>

</table>
<br>

<hr>

<a name="6"></a><h2>6. Proposed Extensions</h2>

<a name="6.1"></a><h3>6.1 External R-Groups</h3>

<p>Daylight proposed, and OpenEye actually implemented, an extension that
specifies bonds to external R-groups.  An external R-group is specified
using ampersand '&amp;' followed by a ring-closure specification (either a
digit, or % and two digits).  However, unlike ring-closures, the bond is to
an external, unspecified R-group.  Example: "n1c(&1)c(&2)cccc1" - 2,3-substituted pyridine.</p>

<a name="6.2"></a><h3>6.2 Quadruple Bonds</h3>

<p>OpenEye implemented quadruple bonds using the '$' symbol; the example
they cite is octachlorodirhenate (III), "[Rh-](Cl)(Cl)(Cl)(Cl)$[Rh-](Cl)(Cl)(Cl)Cl".

<a name="6.2"></a><h3>6.2 Polymers and Crystals</h3>

<p>Daylight (Weininger) proposed, but never implemented, an extension for crystals and
polymers.  Daylight also used the ampersand '&amp;' character, (which may
conflict with the R-group proposal, above), but with the added rule that 
if a number appears more than once, it creates a repeating unit.

<table class="et">
  <tr><td class="ecbc"> c1ccccc1C&1&1 </td> <td class="ec"> polystyrene </td> </tr>
  <tr><td class="ecbc"> C&1&1&1&1     </td> <td class="ec"> diamond     </td> </tr>
  <tr><td class="ecbc"> c&1&1&1       </td> <td class="ec"> graphite    </td> </tr>
</table>

<a name="6.3"></a><h3>6.3 '@' for Cis/Trans around Double Bonds</h3>

<p>The '/' and '\' marks for cis/trans bonds seem simple on the surface but
are problematic for complex systems.  For example, in a long series of
conjugated double bonds, changing the configuration of one bond can require
rewriting dozens of bond symbols.</p>

<p>More importantly, there is a theoretical flaw with the use of '/' and
'\'.  In a cyclo-ene (<i>name??</i>) ring with an even number of double bonds, it is
not possible to write a valid SMILES.  (Recall that '/' and '\' reverse
sense if moved from the left to the right of the atom, thus "C/1=C/CCCCCCC1"
represents a cis configuration even though '/' appears twice.)

<table class="et">
  <tr><td class="ec"><img src="cyclooctatetraene.gif"><td class="ecbc"> C/1=C/C=C\C=C/C=C\1 </td> <td class="ec"> Illegal SMILES </td> </tr>
</table>

<p>The SMILES above is illegal because the first and second "C1" have
opposite bond symbols '/' versus '\', so the single bond that was "broken"
to create the ring has to be both "up" and "down".  This logical
flaw follows from using "up" and "down" in a linear notation, when in
fact the atoms form a circle.</p>

<p>The proposed syntax for cis/trans configurations uses the '@' symbol on
the allenal atoms.  For example:

<table class="et">
  <tr>
    <td class="ec"><img src="trans-difluoroethene.gif"></td>
    <td class="ecbc"> F[C@@H]=[C@H]F<br>F[C@H]=[C@@H]F  </td>
    <td class="ec"> trans-difluoroethene</td>
  </tr>
  <tr>
    <td class="ec"><img src="cis-difluoroethene.gif"></td>
    <td class="ecbc"> F[C@H]=[C@H]F<br>F[C@@H]=[C@@H]F</td>
    <td class="ec"> cis-difluoroethene</td>
  </tr>
</table>

<p>Interpretation of '@' and '@@' follows the tetrahedral convention:
The atoms, as encountered in the SMILES string, are either in anticlockwise
'@' or clockwise '@@' order as viewed on the page.  Since cis/trans
configurations are planar, they can also be "viewed from underneath the
page", which results in the two valid SMILES shown for each compound,
above.</p>

<p>Note that in all cases, cis and trans are easy for the chemist to
distinguish visually: A trans form always has opposite "clock-ness" (@,@@ or
@@,@), and the cis form always has the same "clock-ness" (@,@ or @@,@@) for
the allenal atoms.</p>

<p>This proposed form of cis/trans specification using '@' and '@@' does not suffer from the
theoretical flaw illustrated above:</p>

<table class="et">
  <tr><td class="ec"><img src="cyclooctatetraene.gif"><td class="ecbc"> [C@H]1=[C@@H][C@@H]=[C@@H][C@@H]=[C@@H][C@@H]=[C@@H]1 </td> <td class="ec"> cyclooctatetraene </td> </tr>
</table>

<p>Note that the first allenal carbon must be represented as '@' since the
'1' follows the H, whereas the rest of the allenal carbons use '@@' to
characterize the cis configuration of each bond.  Since this is a
specification on the atom, rather than the single bond, no conflict arises
at the ring-closure bond.</p>

<a name="6.5"></a><h3>6.5 Radicals</h3>

<p><i>This section needs considerable work.  The following text is courtesy Chris Morley, who
commented: "I guess the last paragraph doesn't look too good in a formal specification. There are
two reasons for the frailty: lack of proof that the radical and aromatic uses can always be
unambigous (I doubt anybody has tried); and a known deficiency in the parser."  However, it is a
good starting point...</i></p>

<p>A single lowercase symbol is interpreted as a radical center. CCc is an alternative to CC[CH2] and
is the 1-propyl radical; CcC or C[CH]C is the 2-propyl radical, Co is the methoxy radical. An odd
number of adjacent lowercase symbols is a delocalised conjugated radical. So Cccccc is CC=CC=C[CH2]
or CC=C[CH]C=C or C[CH]C=CC=C Lowercase "c" or "n" can be used in a ring: C1cCCCC1 is the cyclohexyl
radical.</p>

<p>The use of the non-aromatic lowercase symbol is a shorted form with improved intelligibilty that
allows the use of implicit hydrogen in radicals. However it is intended only for simple unambiguous
molecules and is not reliable when combined with aromatic atoms.</p>

<hr>

<a name="7"></a><h2>7. APPENDIX 1: References and Citations</h2>

<a name="7.1"></a><h3>7.1 Groups</h3>
<pre>
Blue Obelisk
  http://blueobelisk.sourceforge.net/
</pre>

<a name="7.2"></a><h3>7.2 Documentation</h3>

<pre>
Daylight
  http://www.daylight.com/dayhtml/doc/theory/theory.smiles.html

OpenEye
  http://www.eyesopen.com/docs/html/pyprog/TheSMILESLineNotation.html
  http://www.eyesopen.com/docs/html/pyprog/DaylightSMILES.html

OpenBabel
  http://openbabel.sourceforge.net/wiki/Radicals_and_SMILES_extensions
  http://openbabel.sourceforge.net/wiki/SMILES

Wikipedia
  http://en.wikipedia.org/wiki/Simplified_molecular_input_line_entry_specification

</pre>

<a name="7.3"></a><h3>7.3 Toolkits</h3>

<pre>
CDK
  http://almost.cubic.uni-koeln.de/cdk/cdk_top

Marvin
  http://umbbd.msi.umn.edu/search/marvin/doc/user/smiles-doc.html

RDKit
  http://www.rdkit.org/

Frowns
  http://frowns.sourceforge.net/frowns.html

PerlMol.org
  http://search.cpan.org/~itub/Chemistry-File-SMILES-0.45/SMILES.pm

InChI
  http://www.iupac.org/inchi/
  http://inchi.info/
  http://en.wikipedia.org/wiki/International_Chemical_Identifier
</pre>

<a name="7.3"></a><h3>7.3 Relevant Scientific Papers</h3>

<pre>
  David Weininger  (1988)
  SMILES, a Chemical Language and Information System. 1. Introduction to Methodology and Encoding Rules,
  Journal of Chemical Information and Computer Sciences 28:31-36.

  David Weininger, Arthur Weininger, and Joseph L Weininger  (1989)
  SMILES 2. Algorithm for Generation of Unique SMILES Notation
  Journal of Chemical Information and Computer Sciences 29:97-101.

  Morgan's original canonicalization paper

  Relevant papers from Stanford's DENDRAL and CANGEN projects?
</pre>

<a name="7.5"></a><h3>7.5 Molecule Editors that can produce SMILES</h3>
<pre>
  JME
  CACTVS
  ISISDraw?
  ChemDraw
  (Firefly - to be renamed)
  ACD/ChemSketch
  MarvinSketch http://www.chemaxon.com/product/msketch.html
</pre>

<br>
<hr>
<p>Copyright &copy; 2007, Craig A. James</p>

<p>This document is licensed under the <a href="http://creativecommons.org/licenses/by-nc/2.0/">Creative 
  Commons Deed, "Attribution - Non Commercial 2.0"</a>.</p>
<p>You are free:</p>

<ul>
  <li> to copy, distribute, display, and perform the work</li>
  <li> to make derivative works</li>
</ul>
<p>under the following conditions:</p>
<ul>
  <li> You must give the original author credit.</li>
  <li> You may not use this work for commercial purposes.</li>
</ul>
<p>For any reuse or distribution, you must make clear to others the license terms of this work. Any of 
  these conditions can be waived if you get permission from the copyright holder. Your fair use and other 
  rights are in no way affected by the above.</p>

</body>
</html>
